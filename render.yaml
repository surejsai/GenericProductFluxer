services:
  - type: web
    name: fluxer-atelier
    runtime: python
    region: oregon  # or singapore, frankfurt, ohio
    plan: free  # or starter, standard, pro
    buildCommand: pip install poetry && poetry config virtualenvs.create false && poetry install --without dev --no-interaction
    startCommand: gunicorn wsgi:app --bind 0.0.0.0:$PORT --workers 1 --timeout 300 --graceful-timeout 60
    envVars:
      - key: FLASK_ENV
        value: production
      - key: FLASK_DEBUG
        value: "false"
      - key: PYTHON_VERSION
        value: "3.12.0"
      - key: SERP_API_KEY
        sync: false  # Set manually in dashboard
      - key: FIRECRAWL_API_KEY
        sync: false
      - key: OPENAI_API_KEY
        sync: false
      - key: EXTRACTOR_TYPE
        value: firecrawl
      - key: EXTRACTION_WORKERS
        value: "1"  # Sequential processing for free tier memory limits
      - key: LOG_LEVEL
        value: INFO
    healthCheckPath: /health
